---
# TODO case insensitiveness
scopeName: source.powerbuilder
uuid: EF182D00-2D16-4148-B916-27632C956F35
fileTypes:
- sru
- srd
- srm
- srw
- srs
- srf
- sra
- srp
- srj
- srq
- pbl
- pbt
- pbw
name: PowerBuilder
patterns:
  - include: '#precompile'
  - include: '#strings'
  - include: '#comments'
  - include: '#keywords'
  - include: '#literals'
  - include: '#special_rules'
  - include: '#final'
repository:
  special_rules:
    patterns:
      - name: comment.block.documentation.headers.powerbuilder
        match: ^(HA)?\$.*$

      - name: meta.variable.declaration.powerbuilder
        match: '(?<=^|[;,\(])\s*(\w[\w\d$#%\-]*)\s+(\w[\w\d$#%\-]*)\s*(?=$|[;,\)])'
        captures:
          1:
            patterns:
              - include: '#types'
          2:
            name: variable.other.local.powerbuilder

      - name: meta.member.powerbuilder
        match: (::|\.)(\w[\w\d$#%\-]*)
        captures:
            2:
              name: variable.other.member.powerbuilder

      - name: meta.function.powerbuilder
        match: (\w[\w\d$#%\-]*)\s*[(]
        captures:
            1:
              name: entity.name.function.powerbuilder

  literals:
    patterns:
      - name: constant.numeric.date.powerbuilder
        match: \b\d{4}-\d{2}-\d{2}\b
      - name: constant.numeric.time.powerbuilder
        match: \b\d{2}:\d{2}:\d{2}(.\d+)?\b
      - name: constant.numeric.number.powerbuilder
        match: \b(\d+(\.\d+)?|(\.\d+))([eE][+\-]\d+)?\b
      - name: constant.language.boolean.powerbuilder
        match: (?i)\s*\b(true|false)\b
      - name: constant.language.enumerated.powerbuilder
        match: \s*\b\w[\w\d$#%\-]*!
      
  types:
    patterns:
      - include: '#primitives'
      - name: storage.type.complex.powerbuilder
        match: (\w[\w\d$#%\-]*)

  primitives:
    patterns:
      - name: storage.type.primitives.powerbuilder
        match: (?i)\s*\b(any|blob|boolean|byte|char|character|date|datetime|dec|decimal|double|int|integer|long|longlong|longptr|real|string|time|uint|ulong|unsignedinteger|unsignedlong)\b

  final:
    patterns:
      - include: '#primitives'
      - name: keyword.operator.symbols.powerbuilder
        match: (\+|\-|\*|\/|\^|=|>|<|&)

  keywords:
    patterns:
      - name: keyword.operator.boolean.powerbuilder
        match: (?i)\s*\b(or|and|xor|not)\b
      - name: keyword.operator.sql.powerbuilder
        match: (?i)\s*\b(is|close|create|destroy|using|select|delete|insert|describe|update|null|from|into|values|where|commit|connect|disconnect|selectblob|updateblob|execute|declare|prepare|dynamic|fetch|first|prior|last|rollback|immediate|descriptor|cursor\s+for|procedure\s+for)\b


      - name: storage.modifier.variable.powerbuilder
        match: (?i)\s*\b(constant|readonly|ref)\b

      - name: storage.modifier.access.powerbuilder
        match: (?i)\s*\b(public|private|protected|privatewrite|privateread|protectedread|protectedwrite|systemread|systemwrite)\b

      - name: variable.language.powerbuiler
        match: (?i)\s*\b(super|this|sqlca|parent)\b

      - name: storage.modifier.access.powerbuilder
        match: (?i)\s*\b(window|indirect|variables|end\s+variables|forward|end\s+forward|type|end\s+type|prototypes|within|autoinstantiate|alias|library|system|rpcfunc)\b

      - name: storage.modifier.scope.powerbuilder
        match: (?i)\s*\b(global|shared|local)\b

      - name: keyword.other.functions.powerbuilder
        match: (?i)\s*\b(return|function|end\s+function|subroutine|end\s+subroutine|throw|event|end\s+event|on|end\s+on|call|post|trigger|open|static)\b

      - name: keyword.control.powerbuilder
        match: (?i)\s*\b(if|then|else|elseif|case|choose|exit|continue|for|to|step|next|do|while|loop|until|try|catch|finally|release|end|goto|halt)\b

      - name: keyword.other.reserved.powerbuilder
        match: (?i)\s*\b(namespace|intrinsic|with|_debug|enumerated|of|external|native)\b


  precompile:
    patterns:
      - name: name.section.conditional_compilation.powerbuilder
        match: ^\s*#.*$


  strings:
    patterns:
      - name: string.quoted.double.powerbuilder
        begin: \"
        end: \"
        patterns:
          - name: constant.character.escape.powerbuilder
            match: ~.

      - name: string.quoted.single.powerbuilder
        begin: \'
        end: \'
        patterns:
          - name: constant.character.escape.powerbuilder
            match: ~.

  comments:
    patterns:
      - name: comment.line.double-slash.powerbuilder
        match: //.*$
      - name: comment.block.documentation.powerbuilder
        begin: /\*
        end: \*/
  
